void 0===window.SJ&&(window.SJ={}),SJ.Lucky={randomNum:function(e,t){var t=t||1e5;return Math.floor(e+Math.random()*t)},randomNumNoRepeat:function(e){function t(){return Math.random()>.5?-1:1}return e.sort(t)},arrFilter:function(e,t){var n,i,o=[];for(n=0;n<e.length;n+=1)o.push(e[n]);for(n=0;n<t.length;n+=1)for(i=0;i<o.length;i+=1)t[n].id!==o[i].id||(delete o[i],o.splice(i,1));return o},draw:function(e,t,n){var i=this;$(e).children().length;var o,a=[],s=[],l=j=0,r=arguments[3]?arguments[3]:function(){},c=arguments[4]?arguments[4]:100,d=arguments[5]?arguments[5]:600,g=arguments[6]?arguments[6]:800,f=arguments[7]?arguments[7]:2800;$.ajax({type:"GET",url:"js/staffsList.json",datatype:"json"}).done(function(h){function u(t){o=setInterval(function(){j<s.length?($(e).children(":eq("+s[j].id+")").addClass("active").siblings().removeClass("active"),j+=1):(s=i.randomNumNoRepeat(s),j=0)},t)}for($(e).empty(),a=h,l=0;l<a.length;l+=1){var m='<li><div class="sj-avatar-shadow"></div><img src="'+a[l].avatar+'" alt="'+a[l].name+'">'+"</li>";$(e).append(m)}s=i.randomNumNoRepeat(a),$(t).on("click",function(){1!==s.length&&($(this).prop("disabled","disabled").addClass("disabled"),$(n).removeAttr("disabled").removeClass("disabled"),u(c))}),$(n).on("click",function(){$(this).prop("disabled","disabled").addClass("disabled");var n=setTimeout(function(){clearInterval(o),u(g),n=setTimeout(function(){clearInterval(o);var n=[];for(u=0;u<a.length;u+=1)a[u].RL&&n.push(a[u]);var l=[];for(u=0;u<a.length;u+=1)a[u].WL||l.push(a[u]);if(n.length>0)setTimeout(function(){for($(e).children(":eq("+n[0].id+")").attr("class","bingo").siblings().removeClass("active"),r($(e).children(":eq("+n[0].id+")")),u=0;u<s.length;u+=1)if(s[u].id===n[0].id){delete s[u],s.splice(u,1),delete n[0],n.splice(0,1);break}1!==s.length?$(t).removeAttr("disabled").removeClass("disabled"):1===s.length&&console.log("啊哦，最后一个都抽不到你，杯具啊！")},g);else{var c=$(e).children('li[class="active"]'),d=c.index();if(l.length>0){var f=i.arrFilter(s,l),h=!0;for(u=0;u<l.length;u+=1){if(l[u].id===d){h=!0;break}h*=!1}if(h)console.log("Yes, he's in the BL"),setTimeout(function(){for($(e).children(":eq("+f[0].id+")").attr("class","bingo").siblings().removeClass("active"),r($(e).children(":eq("+f[0].id+")")),u=0;u<s.length;u+=1)if(s[u].id===f[0].id){delete s[u],s.splice(u,1);break}s.length!==l.length?$(t).removeAttr("disabled").removeClass("disabled"):s.length===l.length&&console.log("那么多人都抽不到你，自认倒霉吧~！！"),console.log("剩下参加奖的人："+s)},g);else{console.log("No, he's not in the BL"),c.attr("class","bingo"),r(c);for(var u=0;u<s.length;u+=1)if(s[u].id===d){delete s[u],s.splice(u,1);break}s.length!==l.length?$(t).removeAttr("disabled").removeClass("disabled"):s.length===l.length&&console.log("那么多人都抽不到你，自认倒霉吧~！！"),console.log("剩下参加奖的人："+s)}}else{c.attr("class","bingo"),r(c);for(var u=0;u<s.length;u+=1)if(s[u].id===d){delete s[u],s.splice(u,1);break}1!==s.length?$(t).removeAttr("disabled").removeClass("disabled"):1===s.length&&console.log("啊哦，最后一个都抽不到你，杯具啊！")}}},f)},d)})}).fail(function(e,t,n){console.log(e),console.log(t),console.log(n)})},ceilingLight:function(e,t){var n=this,i=1e3,o=function(){i=n.randomNum(1e3,1600),$(e+":eq(0)").stop(!0,!1).animate({opacity:.3},i,function(){$(this).animate({opacity:0},i,function(){o()})})},a=function(){i=n.randomNum(1e3,1600),$(e+":eq(1)").stop(!0,!1).animate({opacity:.3},i,function(){$(this).animate({opacity:0},i,function(){a()})})},s=function(){i=n.randomNum(1e3,1600),$(e+":eq(2)").stop(!0,!1).animate({opacity:.3},i,function(){$(this).animate({opacity:0},i,function(){s()})})};if("on"===t)return o(),a(),s(),"Ceiling lights on !";if("off"===t){var l,r=$(e).length;for(l=0;r>l;l+=1)$(e+":eq("+l+")").stop(!0,!1).animate({opacity:0},1e3);return"Ceiling lights off !"}},screenLight:function(e,t,n){var i=function(){$(e).stop(!0,!1).animate({opacity:.75},t,function(){$(this).animate({opacity:.25},t,function(){i()})})};return"on"===n?(i(),"Screen lights on !"):"off"===n?($(e).stop(!0,!1).animate({opacity:.25},1e3),"Screen lights off !"):void 0}},SJ.Lucky.ceilingLight("#sjCeiling .sj-ceiling-light","on"),SJ.Lucky.screenLight("#sjScreen",2e3,"on"),SJ.Lucky.draw("#sjLuckyList","#drawBeginBtn","#drawStopBtn",function(e){var t=e.offset().top,n=e.offset().left,i=$("#sjPodium").offset().top,o=$("#sjPodium").offset().left+15,a=19,s=-20,l=bHeight=64,r=i,c=o,d=$(".sj-bingo").length,g=10,f=e.children("img").attr("alt");bingo=e.clone().html(),$bingo=$('<div class="sj-bingo">'+bingo+'<div class="sj-avatar-name">'+f+'<div class="arrow-bottom"></div></div></div>'),$bingo.appendTo("body").css({top:t,left:n});var h=d%g,u=Math.floor(d/g);r=i+u*(bHeight+s),c=o+h*(l+a),$bingo.delay(800).animate({top:r,left:c},600,function(){var e=$(this).children(".sj-avatar-name"),t=e.outerWidth();console.log(t),e.css({left:"50%","margin-left":-t/2}),e.show().addClass("animated bounceInUp")})});